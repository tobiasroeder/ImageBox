/*
    ImageBox v1.3.1
    (c) Tobias Roeder
    tobiasroeder.github.io/imagebox/license
*/
const imagebox={init(a=""){if(this.settings.autoInit||"autoload"!==a)this.settings.info&&console.log("%cImageBox v1.3.1\nhttps://tobiasroeder.github.io/imagebox","color:#39c"),this.settings.keyControls&&(window.onkeyup=b=>{if(document.body.classList.contains("imagebox"))switch(b.code){case "Escape":this.close();break;case "ArrowLeft":(b=document.querySelector(".ib-control-left"))&&b.click();break;case "ArrowRight":(b=document.querySelector(".ib-control-right"))&&b.click()}}),this.finder()},galleryNames:[],galleries:[],finder(){let a=document.querySelectorAll("img[data-imagebox]");0<this.galleries.length&&(this.galleries=[]);a.forEach(b=>{let c=b.dataset.imagebox;b.addEventListener("click",function(d){d.preventDefault();d.stopPropagation();imagebox.open(this)});""!==c&&(imagebox.galleryNames.includes(c)||imagebox.galleryNames.push(c))});imagebox.galleryNames.forEach(b=>{b=document.querySelectorAll(`[data-imagebox="${b}"]`);imagebox.galleries.push(b)});imagebox.galleries.forEach((b,c)=>{b.forEach((d,f)=>{d.setAttribute("data-imagebox-image-index",f);d.setAttribute("data-imagebox-gallery-index",c)})})},settings:{info:!1,swipeToChange:!0,swipeToClose:!0,keyControls:!0,closeEverywhere:!0,htmlCaption:!1,autoInit:!0},options({info:a=!1,swipeToChange:b=!0,swipeToClose:c=!0,keyControls:d=!0,closeEverywhere:f=!0,htmlCaption:e=!1,autoInit:k=!0}){this.settings.info=a;this.settings.swipeToChange=b;this.settings.swipeToClose=c;this.settings.keyControls=d;this.settings.closeEverywhere=f;this.settings.htmlCaption=e;this.settings.autoInit=k},open:a=>{let b=!0;var c=a.dataset.imagebox;if("image"===c||""===c)b=!1;c=null;document.body.classList.add("imagebox");null==document.querySelector("#imagebox")&&(c=document.createElement("div"),c.setAttribute("id","imagebox"),c.setAttribute("class","ib-remove"),document.body.appendChild(c));c=a.dataset.imageboxSrc??a.src;let d=document.querySelector("#imagebox"),f=null,e=null,k=null,h=null,g=null,l=null,n=null,p=null;b&&(h=parseInt(a.dataset.imageboxImageIndex),g=parseInt(a.dataset.imageboxGalleryIndex),l=imagebox.galleries[g].length,0==h&&(n="disabled"),h==l-1&&(p="disabled"),f=`<div class="ib-control"><div class="ib-control-left" ${n}></div><div class="ib-control-right" ${p}></div></div>`,e=`<div class="ib-indexes"><span class="ib-current-index">${h+1}</span> / <span class="ib-last-index">${l}</span></div>`,k='<img src="" class="ib-image ib-image-next ib-hidden">');d.innerHTML=`<div class="ib-loading"></div><div class="ib-content"><div class="ib-topbar">${e}<div class="ib-buttons"><div class="ib-close ib-button"></div></div></div>${f}<div class="ib-image-wrapper"><img src="${c}" class="ib-image ib-image-current">${k}</div><div class="ib-caption"></div></div>`;b?(d.querySelector(".ib-control-left").addEventListener("click",m=>{m.preventDefault();m.stopPropagation();imagebox.prev(h--,g)}),d.querySelector(".ib-control-right").addEventListener("click",m=>{m.preventDefault();m.stopPropagation();imagebox.next(h++,g)})):imagebox.settings.closeEverywhere&&d.querySelector(".ib-content").addEventListener("click",()=>{imagebox.close()});d.querySelector(".ib-close").addEventListener("click",()=>{imagebox.close()});imagebox.caption(a);imagebox.fade.in(d);document.querySelector("#imagebox .ib-image").onload=()=>{document.querySelector("#imagebox .ib-loading").style.opacity="0";document.querySelector("#imagebox .ib-image-wrapper").style.opacity="1"};imagebox.swipe(document.querySelector("#imagebox .ib-content"),b)},close:()=>{document.body.classList.remove("imagebox");let a=document.querySelector("#imagebox");a.classList.remove("ib-remove");imagebox.fade.out(a)},change:(a,b,c)=>{let d=document.querySelector("#imagebox .ib-loading"),f=imagebox.galleries[b].length;b=document.querySelector(`img[data-imagebox-image-index='${a}'][data-imagebox-gallery-index='${b}']`);let e=document.querySelector("#imagebox .ib-control-left"),k=document.querySelector("#imagebox .ib-control-right"),h=document.querySelector("#imagebox .ib-current-index");d.style.opacity="1";"prev"==c&&(0==a&&e.setAttribute("disabled",""),k.removeAttribute("disabled"));"next"==c&&(a==f-1&&k.setAttribute("disabled",""),e.removeAttribute("disabled"));h.innerText=a+1;let g=document.querySelector("#imagebox .ib-image-next"),l=document.querySelector("#imagebox .ib-image-current");l.classList.add("ibFadeOut");g.src=b.dataset.imageboxSrc??b.src;imagebox.caption(b);g.onload=()=>{g.classList.add("ibFadeIn");d.style.opacity=0;setTimeout(()=>{l.className="ib-image ib-hidden ib-image-next";l.src="";g.className="ib-image ib-image-current"},600)}},prev:(a,b)=>{0!=a&&(a=0>=a?a=0:a-1,imagebox.change(a,b,"prev"))},next:(a,b)=>{let c=imagebox.galleries[b].length-1;a!=c&&(a=a>=c?a=c:a+1,imagebox.change(a,b,"next"))},caption(a){a=a.getAttribute("data-imagebox-caption");let b=document.querySelector("#imagebox .ib-caption");this.settings.htmlCaption?b.innerHTML=a:b.textContent=a;a?(-1<a.indexOf("{loc}")?(b.classList.add("location"),a=a.replace(/{loc}/,""),b.textContent=a):b.classList.remove("location"),b.style.display="block"):b.style.display="none"},swipe:(a,b)=>{a&&(a.ontouchstart=c=>{let d=c.layerX,f=c.layerY;a.ontouchend=e=>{let k=d-e.layerX;e=f-e.layerY;let h=window.innerWidth/10,g=window.innerHeight/10;imagebox.settings.swipeToClose&&(e>=g||e<=-g)&&imagebox.close();b&&imagebox.settings.swipeToChange&&(k>=h&&document.querySelector("#imagebox .ib-control-right").click(),k<=-h&&document.querySelector("#imagebox .ib-control-left").click())}})},fade:{duration:.1,out:(a,b=!1,c)=>{a.style.opacity=1;(function f(){let e=parseFloat(a.style.opacity);0>(e-=imagebox.fade.duration)?(c&&c(),b&&document.querySelector("#imagebox .ib-image-wrapper").removeChild(a),a.style.display="none"):(a.style.opacity=e,requestAnimationFrame(f))})()},in:(a,b)=>{a.style.opacity=0;a.style.display="block";(function d(){let f=parseFloat(a.style.opacity);1<(f+=imagebox.fade.duration)?b&&b():(a.style.opacity=f,requestAnimationFrame(d))})()}}};window.addEventListener("load",function(){imagebox.init("autoload")});